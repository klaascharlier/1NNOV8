<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>1NNOV8</title>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

</head>
<body>

<script>
    var body = d3.select("body")
            .attr("bgcolor", "grey");

    var scale = 2.6;

    var dimensions = {
        width: scale * 360,
        height: scale * 225
    };

    var lineThickness = dimensions.width*0.005;

    var svg = body.append("svg")
            .attr("width", dimensions.width)
            .attr("height", dimensions.height)
            .attr("align", "center");

    var field = svg.append("rect")
            .attr("width", dimensions.width)
            .attr("height", dimensions.height)
            .attr("fill", "green");

    var fieldRect = svg.append("rect")
            .attr("width", dimensions.width - 10*lineThickness)
            .attr("height", dimensions.height - 10*lineThickness)
            .attr("x", 5*lineThickness)
            .attr("y", 5*lineThickness)
            .attr("fill", "green")
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("onmouseover", "hideOptions()");

    var middleLine = svg.append("rect")
            .attr("width", lineThickness)
            .attr("height", dimensions.height - 10*lineThickness)
            .attr("x", (dimensions.width -lineThickness) * 0.5)
            .attr("y", 5*lineThickness)
            .attr("fill", "white");

    var middleCircle = svg.append("circle")
            .attr("cx", dimensions.width * 0.5)
            .attr("cy", dimensions.height * 0.5)
            .attr("r", dimensions.width * 0.075)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var leftBackCircle = svg.append("circle")
            .attr("cx", dimensions.width - dimensions.width * 0.15)
            .attr("cy", dimensions.height * 0.5)
            .attr("r", dimensions.width * 0.08)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var rightBackCircle = svg.append("circle")
            .attr("cx", dimensions.width - dimensions.width * 0.85)
            .attr("cy", dimensions.height * 0.5)
            .attr("r", dimensions.width * 0.08)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var middleStip = svg.append("circle")
            .attr("cx", dimensions.width * 0.5)
            .attr("cy", dimensions.height * 0.5)
            .attr("r", lineThickness*4)
            .attr("stroke", "white")
            .attr("fill", "white")
            .attr("onmouseover", "showOptions()");

    var leftBigBak = svg.append("rect")
            .attr("width", dimensions.width/6)
            .attr("height", dimensions.height*0.5)
            .attr("x", 5*lineThickness)
            .attr("y", dimensions.height*0.25)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var rightBigBak = svg.append("rect")
            .attr("width", dimensions.width/6)
            .attr("height", dimensions.height*0.5)
            .attr("x", dimensions.width - dimensions.width/6 - 5*lineThickness)
            .attr("y", dimensions.height*0.25)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var leftSmallBak = svg.append("rect")
            .attr("width", dimensions.width/14)
            .attr("height", dimensions.height*0.2)
            .attr("x", 5*lineThickness)
            .attr("y", dimensions.height*0.4)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var rightSmallBak = svg.append("rect")
            .attr("width", dimensions.width/14)
            .attr("height", dimensions.height*0.2)
            .attr("x", dimensions.width - dimensions.width/14 - 5*lineThickness)
            .attr("y", dimensions.height*0.4)
            .attr("stroke", "white")
            .attr("stroke-width", lineThickness)
            .attr("fill", "green");

    var activeMenu = "none";
    var activeReferee = "none";
    var menuItems = ["teams", "referees", "something else", "eijfao", "fee","teams", "referees", "something else", "eijfao", "fee",];

    var options = [];

    var teamsList = [];
    d3.text("1516.csv", "text/csv", function (unParsedData) {  //Alles met data binnen deze scope
        Data = d3.csv.parse(unParsedData);

        //gets the unique teams
        var teams = [];
        Data.forEach(function(d) {
            var found = false;
            for(var i = 0; i<teams.length; i++){
                if(teams[i] == d.HomeTeam){
                    found = true;
                }
            }
            if(!found){
                teams.push(d.HomeTeam);
            }
        });
        teamsList = teams;
        console.log(teams);
    });

    var tempData = {
        "referee1": {"name":"John", "ratio": 0.5},
        "referee2": {"name":"Hugh", "ratio": 0.6},
        "referee3": {"name":"Victor", "ratio": 0.1},
        "referee4": {"name":"Klaas", "ratio": 0.8},
        "referee5": {"name":"Jean", "ratio": 0.55},
        "referee6": {"name":"John", "ratio": 0.4},
        "referee7": {"name":"Hugh", "ratio": 0.44},
        "referee8": {"name":"Victor", "ratio": 0.59},
        "referee9": {"name":"Klaas", "ratio": 0.42},
        "referee10": {"name":"Jean", "ratio": 0.49}
    };

    function drawRefereeData(data){
        var index = 0;
        for(var i in data){
            var name = data[i].name;
            var ratio = data[i].ratio;
            var verdict = "";
            if(ratio > 0.55){
                verdict = "Away whistler";
            } else if (ratio < 0.45){
                verdict = "Home whistler";
            } else if (ratio == 0.5){
                verdict = "Fair as square";
            } else {
                verdict = "Reasonably fair";
            }
            var tooltipInfo = "Referee: " + name + "\nRatio: " + ratio + "\nVerdict: " + verdict;

            var circle = svg.append("circle")
                    .attr("cx", dimensions.width * 0.5)
                    .attr("cy", (index * (dimensions.height* 0.8) / (Object.keys(data).length - 1)) + 0.1*dimensions.height)
                    .attr("r", 0)
                    .attr("stroke", "black")
                    .attr("stroke-width", lineThickness/4)
                    .attr("fill", "yellow")
                    .on('mouseover', function () {
                        d3.select(this).transition().attr("r", lineThickness*4).ease("elastic");
                    })
                    .on('mouseout', function () {
                        d3.select(this).transition().attr("r", lineThickness*3);
                    })
                    .on('click', function () {
                        console.log(tooltipInfo);
                    });

            circle.append("svg:title").text(function () {
                return tooltipInfo;
            });
            circle.transition()
                    .attr("r", lineThickness*3)
                    .attr("cx", dimensions.width * ratio)
                    .duration(3000)
                    .ease("elastic")
                    .delay(0);
            index++;
            console.log(name + ' ' + ratio);
        }
    }

    for(i = 0; i<10; i++){
        var circle = svg.append("circle")
                .attr("cx", Math.sin(360*i/menuItems.length * Math.PI / 180) * dimensions.width * 0.075 + dimensions.width * 0.5)
                .attr("cy", Math.cos(360*i/menuItems.length * Math.PI / 180) * dimensions.width * 0.075 + dimensions.height * 0.5)
                .attr("r", lineThickness*3)
                .attr("stroke", "white")
                .attr("fill", "white")
                .attr("visibility", "hidden")
                .on("click", function(){
                    //console.log(teamsList[i]);
                    drawRefereeData(tempData);
                })
                .on("mouseover", function(){
                    d3.select(this).attr("fill", "red");
                })
                .on("mouseout", function(){
                    d3.select(this).attr("fill", "white");
                });
        options.push(circle);
    }

    function showOptions(){
        for(i=0; i < options.length; i++){
            options[i].attr("visibility", "visible");
        }
    }

    function hideOptions(){
        for(i=0; i < options.length; i++){
            options[i].attr("visibility", "hidden");
        }
    }



</script>


</body>
</html>